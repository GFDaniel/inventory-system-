<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Productos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Productos</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Formulario para crear/editar producto -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>{{ isEditing ? 'Editar Producto' : 'Nuevo Producto' }}</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
        <ion-item>
          <ion-label position="stacked">Nombre *</ion-label>
          <ion-input formControlName="name" placeholder="Nombre del producto"></ion-input>
        </ion-item>
        <div class="error-message" *ngIf="productForm.get('name')?.invalid && productForm.get('name')?.touched">
          El nombre es requerido
        </div>

        <ion-item>
          <ion-label position="stacked">Descripción</ion-label>
          <ion-textarea formControlName="description" placeholder="Descripción del producto"></ion-textarea>
        </ion-item>

        <ion-item>
          <ion-label position="stacked">Precio *</ion-label>
          <ion-input type="number" formControlName="price" placeholder="0.00"></ion-input>
        </ion-item>
        <div class="error-message" *ngIf="productForm.get('price')?.invalid && productForm.get('price')?.touched">
          El precio es requerido y debe ser mayor a 0
        </div>

        <ion-item>
          <ion-label position="stacked">Stock Inicial *</ion-label>
          <ion-input type="number" formControlName="stock" placeholder="0"></ion-input>
        </ion-item>
        <div class="error-message" *ngIf="productForm.get('stock')?.invalid && productForm.get('stock')?.touched">
          El stock es requerido y debe ser mayor o igual a 0
        </div>

        <div class="form-buttons">
          <ion-button type="submit" [disabled]="!productForm.valid">
            {{ isEditing ? 'Actualizar' : 'Crear' }}
          </ion-button>
          <ion-button fill="outline" type="button" (click)="resetForm()" *ngIf="isEditing">
            Cancelar
          </ion-button>
        </div>
      </form>
    </ion-card-content>
  </ion-card>

  <!-- Lista de productos -->
  <ion-card *ngFor="let product of products">
    <ion-card-header>
      <ion-card-title>{{ product.name }}</ion-card-title>
      <ion-card-subtitle>${{ product.price }}</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <p *ngIf="product.description">{{ product.description }}</p>
      <div class="product-info">
        <ion-chip [color]="product.stock > 0 ? 'success' : 'danger'">
          <ion-icon name="cube-outline"></ion-icon>
          <ion-label>Stock: {{ product.stock }}</ion-label>
        </ion-chip>
      </div>
      <div class="product-actions">
        <ion-button fill="outline" size="small" (click)="editProduct(product)">
          <ion-icon name="create-outline" slot="start"></ion-icon>
          Editar
        </ion-button>
        <ion-button fill="outline" color="danger" size="small" (click)="deleteProduct(product)">
          <ion-icon name="trash-outline" slot="start"></ion-icon>
          Eliminar
        </ion-button>
      </div>
    </ion-card-content>
  </ion-card>

  <div *ngIf="products.length === 0" class="empty-state">
    <ion-icon name="cube-outline" size="large"></ion-icon>
    <h2>No hay productos</h2>
    <p>Crea tu primer producto usando el formulario de arriba</p>
  </div>
</ion-content>
